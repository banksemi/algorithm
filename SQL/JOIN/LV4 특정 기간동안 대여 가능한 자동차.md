[틀림] 날짜 조건을 잘못 입력하여 오답 처리됨
- 특히 CAST 사용법을 기억하자.
- 또한 서브 쿼리 없이 쿼리를 작성할 수 있는 방법을 고민하자.

```
SELECT CAR_ID, CAR_TYPE, FEE
FROM
(
    SELECT *, 
    CAST((daily_fee * (100-discount_rate) / 100 * 30) as SIGNED) as FEE 
    FROM 
    CAR_RENTAL_COMPANY_CAR 
    LEFT JOIN CAR_RENTAL_COMPANY_DISCOUNT_PLAN 
    USING (CAR_TYPE)
    WHERE 
        CAR_ID NOT IN (
            SELECT DISTINCT car_id 
            FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY 
            WHERE END_DATE >= '2022-11-01' AND START_DATE <= '2022-11-30'
        ) 
    and DURATION_TYPE="30일 이상"
    and CAR_TYPE in ('세단', 'SUV')
) AS B
WHERE B.FEE >= 500000 and B.FEE < 2000000
ORDER BY B.FEE DESC, B.CAR_TYPE, B.CAR_ID DESC
```

HAVING 개선
```
SELECT CAR_ID, CAR_TYPE, 
CAST((daily_fee * (100-discount_rate) / 100 * 30) as SIGNED) as FEE 
FROM 
CAR_RENTAL_COMPANY_CAR 
LEFT JOIN CAR_RENTAL_COMPANY_DISCOUNT_PLAN 
USING (CAR_TYPE)
WHERE 
    CAR_ID NOT IN (
        SELECT DISTINCT car_id 
        FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY 
        WHERE END_DATE >= '2022-11-01' AND START_DATE <= '2022-11-30'
    ) 
and DURATION_TYPE="30일 이상"
and CAR_TYPE in ('세단', 'SUV')
HAVING FEE >= 500000 and FEE < 2000000
ORDER BY FEE DESC, CAR_TYPE, CAR_ID DESC
```

서브쿼리 제거
- IS NULL과 ON에서 AND로 추가 조건 입력

```
-- 코드를 입력하세요
# 2022년 11/01 부터 11/30까지 대여 가능한 자동차 ID부터 찾기
# SELECT * FROM CAR_RENTAL_COMPANY_CAR 


SELECT CAR_RENTAL_COMPANY_CAR.CAR_ID, CAR_TYPE, 
CAST((daily_fee * (100-discount_rate) / 100 * 30) as SIGNED) as FEE 
FROM 
CAR_RENTAL_COMPANY_CAR 
LEFT JOIN CAR_RENTAL_COMPANY_DISCOUNT_PLAN USING (CAR_TYPE)

LEFT JOIN 
CAR_RENTAL_COMPANY_RENTAL_HISTORY 
    ON CAR_RENTAL_COMPANY_CAR.CAR_ID=CAR_RENTAL_COMPANY_RENTAL_HISTORY.CAR_ID
    AND END_DATE >= '2022-11-01' AND START_DATE <= '2022-11-30'

WHERE 
    CAR_RENTAL_COMPANY_RENTAL_HISTORY.CAR_ID IS NULL
and DURATION_TYPE="30일 이상"
and CAR_TYPE in ('세단', 'SUV')
HAVING FEE >= 500000 and FEE < 2000000
ORDER BY FEE DESC, CAR_TYPE, CAR_ID DESC
```