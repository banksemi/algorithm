[틀림] 사용자가 여러 물건을 구매한 경우가 있기 때문에 distinct 사용해야한다. 이때 COUNT(distinct column)을 사용할 수 있다.

```
WITH YEAR_2021_COUNT AS (
    SELECT COUNT(*) FROM USER_INFO WHERE YEAR(JOINED)=2021
)

SELECT 
    YEAR(sales_date) AS YEAR, 
    MONTH(sales_date) AS MONTH, 
    COUNT(DISTINCT USER_ID) AS PURCHASED_USERS,
    ROUND(COUNT(DISTINCT USER_ID) / (SELECT * FROM YEAR_2021_COUNT), 1) AS PUCHASED_RATIO
FROM 
    USER_INFO 
JOIN ONLINE_SALE USING (USER_ID)
WHERE YEAR(JOINED)=2021
GROUP BY YEAR(sales_date), MONTH(sales_date)
ORDER BY YEAR, MONTH
```


틀린 쿼리
```
SELECT 
    YEAR(sales_date) AS YEAR, 
    MONTH(sales_date) AS MONTH, 
    COUNT(USER_ID) AS PURCHASED_USERS,
    ROUND(COUNT(USER_ID) / (SELECT COUNT(*) FROM USER_INFO WHERE YEAR(JOINED)=2021), 1) AS PUCHASED_RATIO
FROM 
    USER_INFO 
JOIN ONLINE_SALE USING (USER_ID)
WHERE YEAR(JOINED)=2021
GROUP BY YEAR(sales_date), MONTH(sales_date)
ORDER BY YEAR, MONTH
```