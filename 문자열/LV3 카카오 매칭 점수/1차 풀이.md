[틀림] https://school.programmers.co.kr/learn/courses/30/lessons/42893

문자열 파싱(or 정규식)을 베이스로 한 구현 문제다.

2가지 이유로 틀렸고, 이런 문제를 풀 때에는 처음부터 여러 예외 사항을 모두 주석으로 적어두고 놓치지 않는 것이 중요할 것 같다.
1. 링크 계산 로직 오류: 예제를 보고 점수가 올바르게 계산되었는지 확인하자.
2. `<meta>` 키워드가 `>`으로 끝날 수도 있고 `/>`으로 끝날 수도 있다. 예제는 모두 `/>`으로 되어있으나 실제로는 `>`으로 끝나는 예외 케이스(9번)이 있는 것 같다.


```
"""
매칭 점수를 계산해야한다.

- 기본 점수: 텍스트 중 검색어가 등장하는 횟수 (대소문자 무시)
- 링크 점수: 링크로 걸린 다른 웹페이지의 기본 점수 / 외부 링크 수의 합
  - 외부 링크 수: 다른 외부로 연결된 링크의 개수
  
최종 매칭 점수: 기본 점수 + 링크 점수

"""
ABC = set('QWERTYUIOPASDFGHJKLZXCVBNM')
def get_text(text, keyword, end_keyword):
    for i in range(len(text)):
        if text[i:i+len(keyword)] == keyword:
            for j in range(i+len(keyword), len(text)+1):
                temp=text[i:j]
                if end_keyword in temp[len(keyword):]:
                    yield temp
                    break
    
def find_tag(page, tag_name, attribute, requires_word=None):
    for meta_text in get_text(page, '<' + tag_name, '>'):
        if requires_word and not requires_word in meta_text:
            continue
            
        for aaa in get_text(meta_text, attribute+'="', '"'):
            yield aaa.split('"')[1]

def get_base_url(page):
    for url in find_tag(page, 'meta', 'content', 'property="og:url"'):
        return url
    return None

def get_links(page):
    result = []
    for meta_text in get_text(page, '<a', '</a>'):
        for aaa in get_text(meta_text, 'href="', '"'):
            result.append(aaa.split('"')[1])
    return result
            

def get_base_score(text, keyword):
    text = text.upper()
    keyword = keyword.upper()
    score = 0
    for i in range(len(text)):
        temp = text[i:i+len(keyword)]
        if temp != keyword:
            continue
        if i != 0 and text[i-1] in ABC:
            continue
        if i+len(keyword) != len(text) and text[i+len(keyword)] in ABC:
            continue
        score += 1
    return score
    

def solution(word, pages):
    scores = {}
    htmls = {}
    
    for page in pages:
        url = get_base_url(page)
        if url is None or not url.startswith('https://'):
            continue
        htmls[url] = page
        scores[url] = {
            'base': get_base_score(page, word),
            'links': get_links(htmls[url]),
            'refered': []
        }
    for url in scores:
        for link in scores[url]['links']:
            if link in scores:
                scores[link]['refered'].append(url)
        
    for url in scores:
        link_score = 0
        for refer in scores[url]['refered']:
            if refer in scores:
                link_score += scores[refer]['base'] / len(scores[refer]['links'])
        scores[url]['link'] = link_score
        scores[url]['total'] = scores[url]['base'] + scores[url]['link']

    # 매칭 점수가 가장 큰거
    max_score = max([i['total'] for i in scores.values()])
    
    for i, data in enumerate(scores.values()):
        if data['total'] == max_score:
            return i
    answer = 0
    return answer
```