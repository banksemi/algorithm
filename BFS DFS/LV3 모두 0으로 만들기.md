---
URL: https://school.programmers.co.kr/learn/courses/30/lessons/76503
문제 유형:
  - DFS
  - BFS
풀이 날짜: 2025-11-20
정답 여부: 정답
틀린 이유:
마지막 풀이 날짜:
---
등대 문제와 비슷한 유형.


```
"""
6:40 시작

leaf를 사용한 BFS 풀이
DFS 풀이 둘다 가능
"""
import sys
from collections import defaultdict
sys.setrecursionlimit(2**30)
def solution(a, edges):
    answer = -2
    nodes = defaultdict(list)
    
    for _a, _b in edges:
        nodes[_a].append(_b)
        nodes[_b].append(_a)
    leafs = set()
    for i in nodes:
        if len(nodes[i]) == 1:
            leafs.add(i)
    
    # leaf 아닌 시작점 하나 고르기 TODO
    # 모든게 leaf인 케이스 = n =2

    visited = set()
    total_count = 0
    def dfs(node):
        nonlocal total_count
        visited.add(node)
        
        for child in nodes[node]:
            if child in visited:
                continue
            dfs(child) # child 노드의 하위 그룹 확정
            a[node] += a[child] # child 수치를 부모 노드로 전달
            total_count += abs(a[child])
            a[child] = 0 # for debug
    dfs(0)
    return total_count if a[0] == 0 else -1
```

혹은 DFS result 사용
```
def solution(a, edges):
    answer = -2
    nodes = defaultdict(list)
    
    for _a, _b in edges:
        nodes[_a].append(_b)
        nodes[_b].append(_a)
    leafs = set()
    for i in nodes:
        if len(nodes[i]) == 1:
            leafs.add(i)
    
    # leaf 아닌 시작점 하나 고르기 TODO
    # 모든게 leaf인 케이스 = n =2

    visited = set()
    total_count = 0
    def dfs(node): # -> 해결이 필요한 아래 노드의 합
        nonlocal total_count
        visited.add(node)
        count = a[node]
        for child in nodes[node]:
            if child in visited:
                continue
            temp = dfs(child)
            count += temp
            total_count += abs(temp)
        return count
    
    result = dfs(0)
    return total_count if result == 0 else -1
```


BFS 풀이
```
from collections import defaultdict, deque
def solution(a, edges):
    nodes = defaultdict(set)
    
    for _a, _b in edges:
        nodes[_a].add(_b)
        nodes[_b].add(_a)
    leafs = deque()
    for i in nodes:
        if len(nodes[i]) == 1:
            leafs.append(i)
    count = 0
    while leafs:
        leaf = leafs.popleft()
        if len(nodes[leaf]) == 0:
            return count if a[leaf] == 0 else -1
        parent = list(nodes[leaf])[0]
        a[parent] += a[leaf]
        count += abs(a[leaf])
        
        nodes[parent].remove(leaf)
        nodes[leaf].remove(parent)
        if len(nodes[parent]) == 1:
            leafs.append(parent)
    
    
```